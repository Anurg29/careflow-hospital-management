<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Hospital Queue & Bed Monitor</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <div class="container">
    <div class="header">
      <div class="brand">CareFlow Live</div>
      <div class="badge">Django + Channels + DRF</div>
    </div>

    <div class="card" style="margin-bottom: 14px;">
      <h3>Connect</h3>
      <p>Enter a hospital id, connect to the websocket, or poll once.</p>
      <div class="form-row">
        <input id="hospitalId" type="number" placeholder="Hospital ID" />
        <button id="connectBtn" type="button">Connect WS</button>
        <button id="pollBtn" type="button" class="secondary">Poll once</button>
        <span id="statusDot" style="width:14px;height:14px;border-radius:50%;align-self:center;background:#9bb0cc;"></span>
      </div>
    </div>

    <div class="grid" style="margin-bottom: 14px;">
      <div class="card">
        <h3>Live Status</h3>
        <div class="grid" style="grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));">
          <div class="stat"><span class="value" id="liveAvailable">—</span><span class="label">Beds available</span></div>
          <div class="stat"><span class="value" id="liveOccupied">—</span><span class="label">Beds occupied</span></div>
          <div class="stat"><span class="value" id="liveWaiting">—</span><span class="label">Waiting</span></div>
          <div class="stat"><span class="value" id="liveInProgress">—</span><span class="label">In progress</span></div>
          <div class="stat"><span class="value" id="livePredictedWait">—</span><span class="label">Predicted wait (min)</span></div>
        </div>
        <small>Last update: <span id="liveStamp">—</span></small>
      </div>

      <div class="card">
        <h3>Log</h3>
        <div class="log" id="log"></div>
      </div>
    </div>

    <div class="grid">
      <div class="card">
        <h3>Add Patient to Queue</h3>
        <form id="queueForm">
          <div class="form-row">
            <input name="patient" placeholder="Patient name" required />
            <input name="department" placeholder="Department id (optional)" />
          </div>
          <textarea name="symptoms" rows="3" placeholder="Symptoms / notes"></textarea>
          <button type="submit">Create Queue Entry</button>
        </form>
      </div>

      <div class="card">
        <h3>Start Visit</h3>
        <form id="startForm">
          <div class="form-row">
            <input name="queueId" placeholder="Queue entry id" required />
            <button type="submit">Mark In Progress</button>
          </div>
        </form>
        <h3>Complete Visit</h3>
        <form id="completeForm">
          <div class="form-row">
            <input name="queueIdComplete" placeholder="Queue entry id" required />
            <button type="submit">Mark Done</button>
          </div>
        </form>
      </div>

      <div class="card">
        <h3>Add / Update Bed</h3>
        <form id="bedForm">
          <div class="form-row">
            <input name="label" placeholder="Bed label" required />
            <input name="departmentBed" placeholder="Department id (optional)" />
          </div>
          <div class="form-row">
            <select name="status">
              <option value="available">Available</option>
              <option value="occupied">Occupied</option>
              <option value="cleaning">Cleaning</option>
              <option value="maintenance">Maintenance</option>
            </select>
            <input name="patientBed" placeholder="Patient name (if occupied)" />
          </div>
          <button type="submit">Save Bed</button>
        </form>
      </div>
    </div>
  </div>

  <script src="app.js"></script>
</body>
</html>
