# CareFlow Deployment Guide

This guide will help you deploy the CareFlow Hospital Queue Management System to production.

## üìã Prerequisites

1. **GitHub Account** - To push your code
2. **Render Account** - For backend deployment (free tier available)
3. **Netlify Account** - For frontend deployment (free tier available)
4. **MongoDB Atlas** - Already configured ‚úÖ

## üöÄ Deployment Steps

### Part 1: Push to GitHub

1. Initialize git repository (if not already done):
   ```bash
   cd /Users/anuragdineshrokade/Documents/doctor
   git init
   git add .
   git commit -m "Initial commit - CareFlow Hospital Management System"
   ```

2. Create a new repository on GitHub (https://github.com/new)
   - Name: `careflow-hospital-management`
   - Keep it Public or Private
   - Don't initialize with README (we already have code)

3. Push to GitHub:
   ```bash
   git remote add origin https://github.com/YOUR_USERNAME/careflow-hospital-management.git
   git branch -M main
   git push -u origin main
   ```

### Part 2: Deploy Backend to Render

1. **Go to** https://render.com and sign in

2. **Click "New +" ‚Üí "Web Service"**

3. **Connect your GitHub repository**
   - Select: `careflow-hospital-management`
   - Render will detect it's a Python app

4. **Configure the service:**
   - **Name**: `careflow-backend`
   - **Region**: Oregon (US West)
   - **Branch**: `main`
   - **Root Directory**: `backend`
   - **Runtime**: Python 3
   - **Build Command**: `./build.sh`
   - **Start Command**: `gunicorn hospital_queue.asgi:application -k uvicorn.workers.UvicornWorker`
   - **Plan**: Free

5. **Add Environment Variables** (in Render dashboard):
   ```
   DJANGO_SECRET_KEY = [Auto-generated by Render]
   DJANGO_DEBUG = false
   DJANGO_ALLOWED_HOSTS = careflow-backend.onrender.com
   MONGO_URL = mongodb+srv://anuragrokade965:anurag29@cluster1.1mvedwk.mongodb.net/?appName=Cluster1
   MONGO_DB_NAME = careflow
  CORS_ALLOWED_ORIGINS = https://your-frontend-url.netlify.app
   REDIS_URL = (leave empty for now)
   ```

6. **Click "Create Web Service"**
   - Wait for deployment to complete (5-10 minutes)
   - Note your backend URL: `https://careflow-backend.onrender.com`

### Part 3: Deploy Frontend to Netlify

1. **Go to** https://netlify.com and sign in

2. **Click "Add new site" ‚Üí "Import an existing project"**

3. **Connect to GitHub**
   - Authorize Netlify
   - Select: `careflow-hospital-management`

4. **Configure build settings:**
   - **Base directory**: `frontend`
   - **Build command**: `npm run build`
   - **Publish directory**: `frontend/dist`

5. **Add Environment Variables** (in Netlify dashboard):
   ```
   VITE_API_BASE = https://careflow-backend.onrender.com
   VITE_WS_BASE = wss://careflow-backend.onrender.com
   ```

6. **Click "Deploy site"**
   - Wait for deployment (2-3 minutes)
   - Note your frontend URL: `https://your-site-name.netlify.app`

### Part 4: Update Backend CORS Settings

1. Go back to **Render dashboard**
2. Update the `CORS_ALLOWED_ORIGINS` environment variable:
   ```
   CORS_ALLOWED_ORIGINS = https://your-actual-site-name.netlify.app
   ```
3. Click "Save" - this will trigger a redeploy

## ‚úÖ Verification

1. **Visit your frontend URL**: `https://your-site-name.netlify.app`
2. **Test Registration**: Create a new admin account
3. **Test Hospital Creation**: Add a hospital
4. **Test Real-time Features**: Connect WebSocket and add patients

## üîß Troubleshooting

### Backend Issues:
- Check Render logs: Dashboard ‚Üí Your Service ‚Üí Logs
- Ensure all environment variables are set correctly
- Verify MongoDB connection string is correct

### Frontend Issues:
- Check Netlify deploy logs
- Verify `VITE_API_BASE` points to your Render backend URL
- Check browser console for CORS errors

### CORS Errors:
- Ensure `CORS_ALLOWED_ORIGINS` in Render includes your Netlify URL
- Make sure to include `https://` in the URLs
- Redeploy backend after updating CORS settings

## üìù Post-Deployment

### Create Admin User (via Render Shell):
1. Go to Render Dashboard ‚Üí Your Service ‚Üí Shell
2. Run:
   ```bash
   python manage.py createsuperuser
   ```
3. Follow prompts to create admin account

### Custom Domain (Optional):
- **Netlify**: Settings ‚Üí Domain management ‚Üí Add custom domain
- **Render**: Settings ‚Üí Custom domain

## üéâ You're Live!

Your CareFlow application is now deployed and accessible worldwide!

- **Frontend**: https://your-site-name.netlify.app
- **Backend API**: https://careflow-backend.onrender.com/api/
- **Admin Panel**: https://careflow-backend.onrender.com/admin/

## üí° Tips

- Free tier services may sleep after 15 mins of inactivity
- First request after sleeping takes ~30 seconds to wake up
- Upgrade to paid tiers for always-on service and better performance
- Monitor your MongoDB Atlas usage (free tier has 512MB limit)
